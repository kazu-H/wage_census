"0","library(magrittr)"
"0","library(zoo)"
"0",""
"0","testDF <- testDF %>% "
"0","      group_by(group) %>% "
"0","      mutate(c =as.numeric(rollapplyr(a, 5, function(x) {"
"0","      tab <- sort(table(x), decreasing = TRUE)"
"0","      if(length(unique(tab)) == 1) NA"
"0","      #重複するものが２つあるときは、大きい値を採用するように指定している。"
"0","      #ここの出力を指定することで重複が複数ある時の指定ができる。"
"0","      else if(length(unique(tab)) == 3)names(tab)[1]"
"0","      else names(tab)[1]"
"0","    }, fill = NA))"
"0","    ) %>% "
"0","  return()"
"0","  "
